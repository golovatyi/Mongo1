Текст написан для себя. 
На вход поступает нечто подобное (формат rusmark):
    #110: ^Bu^Da^X365^Ea^F|^G|^K|^L0^Hu^Iz^J|
    #920: J
    #900: ^Xm^Ym^9m
    #907: ^CZU^^BRU^A20050504
    #919: ^Arus^N02^Gca
    #919: ^N||
    #2: V= MARCA
    #999: 0000000
    #1000: 01288naa2 2200409   450 
    #801: ^00^!^aRU^c20050504^aRU?
    #100: ^0 ^!^a20050504a20059999mmma0rusy02||||||ca?
    #5: 0050506144750.5?
    #620: ^0 ^!^aRU?
    #899:  ^aЧЗ?
    #607: ^AСАНКТ-ПЕТЕРБУРГ?
    #606: ^AЭкономика^BОсновные сектора экономики
    #606: ^AПромышленность
    #606: ^AСтроительство
    #606: ^AСельское хозяйство
    #606: ^AТранспорт
    #606: ^AСвязь
    #606: ^AЭкология
    #606: ^AЦенообразование^BЦеновая политика
    #606: ^AФинансы
    #606: ^AРынки^BРынки потребительский
    #606: ^AУровень жизни
    #606: ^AДемография
    #606: ^AПраво^BПравонарушения
    #606: ^AСтатистика^BСтатистические данные?
    #998: 461: 0^12001 ^aСанкт-Петербургские ведомости?
    #998: 463: 0^12001 ^a28 апреля^vС.4^1210  ^d2005?
    #463: ^CСанкт-Петербургские ведомости?^H28 апреля^J2005?^SС.4
    #102: RU?
    #101: rus?
    #1: 1:1-0000118?
    #200: ^AЭкономика Санкт-Петербурга и Ленинградской области в I квартале 2005 года^EСообщение территориального органа Федеральной службы государственной статистики по Санкт-Петербургу и Ленинградской области?^BТекст
    #907: ^C^A20080324^B
    #903: Э850527
    *****
    #922: v922
    #1: 1:O-0042902
    #10: ^D72.90
    #101: rus
    #102: RU
    #106: ^ar
    #210: ^aСПб.^cПитер^d2007
    #215: ^A192
    #225: ^AПродажи на 100%!
    #621: 65.290-5
    #908: Б 19
    #606: ^BПродажа^CСбыт^DУправление сбытом
    #700: ^AБакшт^BК. А.
    #920: PAZK
    #900: ^Ta^B05
    #907: ^CZU0^BRUГУК "Московская ЦБС"^A20070104
    #919: ^Arus^N02^Gca^KPSBO
    #919: ^N||
    #899:   ^iБ 19
    #999: 0000000
    #620: ^0 ^! ^aRU^aRU
    #5: 20070104162650.0
    #100: ^0 ^! ^a20070104d20072007u  u0rusa02||||||ca
    #801: ^0 ^!0^aRU^bГУК "Московская ЦБС"^c20070104^gPSBO^aRU
    #1000: 00803nam2 22003131  450 
    #200: ^AПостроение отдела продаж - с "нуля" до максимальных результатов^FК. А. Бакшт
    #907: ^C^A20080324^B
    #903: 65.290-5/Б 19-091736
    #910: ^AC^D^11
    *****
Где первый блок - общего назначения, второй и до ... - данные, которые 
необходимо занести в mondoDB. 

I.      Переменные
+    1.1.    String[] block; -> набор строк из одного блока (деление с пом *****)
+    1.2.    String st -> отдельная строка (#nnn: ......)
+    1.3.    String[][] rusmark -> файл, конвертированный в массив
+    1.4.    Scanner file -> исходный файл
+    1.5.    String[] init -> файл на этапе инициализации
+    1.6.    int cblock; int[] crblock; -> счетчики блоков и рядов в блоке соответственно 

II.     Классы и функции
    2.1.    public class FW -> для работы с файлами 
+        2.1.1.  Scanner fOpen, Scanner fClose -> сами за себя
+        2.1.2.  int CountRows -> счетчик к-ва строк
+        2.1.3.  int CountBlocks -> счетчик блоков
+        2.1.4.  int CrBlock -> счетчик к-ва рядов в каждом блоке
+        2.1.5   int max() -> сам за себя
        В итоге после вызова функции FW.RusMark получаем массив для дальнейшей работы. 

    2.2.    MongoInt -> инициализация базы данных MOngoDb.

    2.3.    SetDict -> Настройка соотношений #... > "имя столбца".
            
    2.4.    MongoConv -> конверсия текста в mongodb
        2.4.1. 
 

III.    Примерный алгоритм (псевдокод)
    Открываем файл, получаем init[] с помощью FW.
    
+    Далее: int cblock = 1; foreach("*****" in file) -> ++cblock; crblock = new int[i].
    i = 0; foreach(st: init){if(st!="*****"){++crblock[i];}else{++i;}
    Создаем массив String[][] rusmark = new String[max(crblock)][i]
    init[]-> -> string[][] rusmark, состоящий из string block[]

    CvM.

    Полученный массив конвертируем в mongo.
    Соединяемся с БД, foreach(st.substring(0,5) in rusmark[][])

     получаем
     символы #INT, обращаемся в словарь блоков rusmark->кодировок, на основании
    их заносим данные в коллекцию MongoDB ({dict(#xxx): "st.substring(5)", ...}).
    


